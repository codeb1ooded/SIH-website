{% load staticfiles %}
<!DOCTYPE html>
<html lang='en'>
  <head>
    <title>Shikshak Arohan</title>
    <meta charset='utf-8' />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta content='' name='description' />
    <meta content='' name='author' />
    <!-- Styles -->
      <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/map.css' %}">
    <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}"/>
    <link rel="stylesheet" href="{% static 'css/custom.css' %}"/>

    <script type="text/javascript" src="{% static 'js/fusioncharts.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/themes/fusioncharts.theme.fint.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/fusioncharts.charts.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/fusioncharts.charts.js' %}"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.11.2/jquery-ui.min.js"></script>
    <script type="text/javascript" src="http://s.codepen.io/assets/libs/modernizr.js"></script>
  </head>
  <body>
    <div class='navbar navbar-default navbar-static-top'>
      <div class='container-fluid'>
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class='navbar-brand' href='#'>Shikshak Arohan</a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li class='active'><a href="../mapcountry">Map</a></li>
            <li><a href="">About</a></li>
          </ul>
        </div>
      </div>
    </div>
    <div class='container-fluid'>
      <div class='row'>
        <div class='col-md-4'>
          <div class='well'>
            <h4>
              Time Filter:
            </h4>
            <div class="date-picker">
            	<div class="input">
            		<div class="to result">To: <span>{{ to }}</span></div>
            		<button><i class="fa fa-calendar"></i></button>
            	</div>
            	<div class="calendar calendar-to"></div>
            </div>

            <div class="date-picker">
            	<div class="input">
            		<div class="from result">From: <span>{{ from }}</span></div>
            		<button><i class="fa fa-calendar"></i></button>
            	</div>
            	<div class="calendar calendar-from"></div>
            </div>
            <br/>
            <h4>
              Category Filter:
            </h4>
            <div class="page">
             <div class="select-dropdown">
               <select id="teachercategory">
                   <option value="all">All</option>
                   <option value="primary">Primary</option>
                   <option value="secondary">Secondary</option>
                   <option value="senior">Senior</option>
               </select>
             </div>
            </div>
            <br/> <br/>
            <a class="btn" href="{{ url }}" id="apply-button">Apply</a>
          </div>
        </div>
        <div class='col-md-8'>
          <div id="chart-container">FusionCharts will render here</div>
        </div>
      </div>
    </div>
    <script>
    var $to = '{{ to }}';
    var $from = '{{ from }}';
    var $teacher_cat = '{{ teacher_category }}';
    $("#teachercategory").val($teacher_cat);
    $(function() {
        $( ".calendar" ).datepicker({
            dateFormat: 'dd-mm-yy',
            firstDay: 1
        });

        $(document).on('click', '.date-picker .input', function(e){
            var $me = $(this),
                    $parent = $me.parents('.date-picker');
            $parent.toggleClass('open');
        });

        $(".calendar-to").on("change",function(){
            var $me = $(this),
                    $selected = $me.val(),
                    $parent = $me.parents('.date-picker');
            $parent.find('.result').children('span').html($selected);
            $to = $selected;
            $("#apply-button").attr("href", "{{ url }}" + "&to=" + $to + "&from=" + $from + "&teachercategory=" + $teacher_cat);
        });

        $(".calendar-from").on("change",function(){
            var $me = $(this),
                    $selected = $me.val(),
                    $parent = $me.parents('.date-picker');
            $parent.find('.result').children('span').html($selected);
            $from = $selected;
            $("#apply-button").attr("href", "{{ url }}" + "&to=" + $to + "&from=" + $from + "&teachercategory=" + $teacher_cat);
        });
    });
    $('#teachercategory').on('change', function(){
        $teacher_cat = this.value;
        $("#apply-button").attr("href", "{{ url }}" + "&to=" + $to + "&from=" + $from + "&teachercategory=" + $teacher_cat);
    });
    </script>
    <script type="text/javascript">
        var json_data = JSON.parse('{{ json_map | escapejs }}');
        FusionCharts.ready(function () {
            var wrCoverage = new FusionCharts(json_data);
            //Configure the second level chart's properties
            wrCoverage.configureLink({
                type: "mscombidy2d",
                overlayButton: {
                    message: 'Back',
                    fontColor: '880000',
                    bgColor: 'FFEEEE',
                    borderColor: '660000'
                }
            }, 0);
            wrCoverage.render();
        });
    </script>
    <script type="text/javascript" src="{% static 'js/jquery.address.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/bootstrap.min.js' %}"></script>
  </body>
</html>
